/*
Đề bài:
-> Ban đầu cho một queue rỗng. Bạn cần thực hiện các truy vấn sau:

1.Trả về kích thước của queue
2.Kiểm tra xem queue có rỗng không, nếu có in ra “YES”, nếu không in ra “NO”.
3.Cho một số nguyên và đẩy số nguyên này vào cuối queue.
4.Loại bỏ phần tử ở đầu queue nếu queue không rỗng, nếu rỗng không cần thực hiện.
5.Trả về phần tử ở đầu queue, nếu queue rỗng in ra -1.
6.Trả về phần tử ở cuối queue, nếu queue rỗng in ra -1.

*/
#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define Faster() ios_base::sync_with_stdio(0);cin.tie(0);cout.tie(0);
#define Test() int t;cin>>t;while(t--)
#define mod 1000000007
void solve(){
  int q;cin >> q;
  queue<int> nameQueue;
  while(q--){
    int number;cin >> number;
    switch(number){
      case 1:
        cout << nameQueue.size() << "\n";
        break;
      case 2:
        if(nameQueue.empty()) cout << "YES\n";
        else cout << "NO\n";
        break;
      case 3:
        int x;cin >> x;
        nameQueue.push(x);
        break;
      case 4:
        if(!nameQueue.empty()) nameQueue.pop();
        break;
      case 5:
        if(!nameQueue.empty()) cout << nameQueue.front() << "\n";
        else cout << -1 << "\n";
        break;
      case 6:
        if(!nameQueue.empty()) cout << nameQueue.back() << "\n";
        else cout << -1 << "\n";
        break;
      Default:
        break;
    }
  }
}

int main() {
  Faster()
  Test()
  solve();
}
/*
                                                                       
                        .:^~!77????????777!~^..                       
                   .^!7????????????????????????7!^.                   
                :~7?????????????????????????????????!:                
             .~???????????JPP5YJ?YP55J?5P55YJ??????????!:             
           .!??????????J&Y?B&&&&GB#PP@&G#@&&@#YJ?????????7:           
         .!???????????7G@BJ77YB##&&YY@@BGBB&##&&G777??????J7:         
        ^??????????????&&&@#Y5&&&&&&&&&&&&&&&&&&&##BPY?7?????!        
       !J?????????????5&P7Y#B&@@@@@@@@@@@@@@@@@@@@@@@@@BJ?????7.      
      7???????????????G#@&G?Y@@@@@@@@@@@@@@@@@@@@@@@@@@@@P??????.     
     !???????????????5@P7P&B#@@@@@@@&GGGGGGGGBB#&@@@@@@@@@Y??????.    
    ^J??????????????7#@@#5?Y@@@@@@@@577777777777?5@@@@@@@@B7?????!    
    ?????????????????#GJB@#B@@@@@@@&?????????????7&@@@@@@@B7?????J:   
   ^J???????????????B@&G7?Y@@@@@@@@P7???????????7P@@@@@@@@5???????!   
   !????????????????@&&&77P@@@@@@@@????????777?JB@@@@@@@@#?????????   
   !???????????????JP#&@BJ&@@@@@@@#YYY5555PPG#&@@@@@@@@@#??????????   
   !??????????????J&@&&G#G@@@@@@@@@@@@@@@@@@@@@@@@@@@@@G???????????   
   ^??????????????J@PJB@?&@@@@@@@@@@@@@@@@@@@@@@@@@@&GJ7??????????7   
   .??????????????JB@&B@P@@@@@@@@@@@@@@@@@@@@@&&#GPJ?7???????????J^   
    ~????????????5@@BG#P#@@@@@@@&JJJJJJJJJJJ????77???????????????7    
     7??????????7#@B@&&5@@@@@@@@P7???????????????????????????????.    
     .???????????G&@@B5B@@@@@@@&????????????????????????????????:     
      .7????????B@&PG&5@@@@@@@@G7??????????????????????????????:      
        !??????J@&&#77G@@@@@@@@J?????????????????????????????7.       
         :7?????5#@&P?&@@@@@@@B7????????????????????????????^         
           ^7J???7JG&G@@@@@@@@J???????????????????????????~.          
             :7????7?J5555555Y?????????????????????????7^             
               .^7??????????????????????????????????7~.               
                  .:~7??????????????????????????7!^.                  
                       .^~!7??????????????7!~^:.                      
                              ..........                              
                                                                   
*/